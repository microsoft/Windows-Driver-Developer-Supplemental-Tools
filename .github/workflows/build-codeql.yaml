# Continuous integration action for the CodeQL components of this repo.
# This downloads the CodeQL CLI and then builds all the queries in the "windows-drivers" folder.

name: Build and Publish Windows CodeQL queries

on:
  # Triggers the workflow on push or pull request events but only for the main and development branches
  push:
    branches: [ main, development, jacob-ronstadt/github_actions_update ]
  pull_request:
    branches: [ main, development ]

  # Allow manual scheduling
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    permissions:
      contents: read
      packages: write
    steps:
    - name: Enable long git paths
      shell: cmd
      run: git config --global core.longpaths true
    
    - name: Clone self (windows-driver-developer-supplemental-tools)
      uses: actions/checkout@v4
      with:
        path: .
        fetch-depth: 0

    - name: codeql init
      uses: github/codeql-action/init@v3
      
    - name: codeql test
      run: C:\hostedtoolcache\windows\CodeQL\2.17.1\x64\codeql\codeql.exe version
    
      
  

